name: Test package
on: [push, pull_request]
jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        stage:
          - test
          - lint
          - install
          - build
    steps:
      - name: Checkout code
        uses: actions/checkout@v6
      - name: Test the project
        env:
          STAGE: ${{ matrix.stage }}
        run: make $STAGE
      - name: Publish report
        uses: mikepenz/action-junit-report@v6.0.1
        if: success() || failure()
        with:
          report_paths: '*junit.xml'
